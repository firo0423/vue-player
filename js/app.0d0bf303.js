(function(e){function t(t){for(var r,c,a=t[0],s=t[1],u=t[2],p=0,h=[];p<a.length;p++)c=a[p],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&h.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"09ac":function(e,t,n){},"3a53":function(e,t,n){"use strict";n("cc54")},5037:function(e,t,n){"use strict";n("bbf8")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o=n("c3a1");n("7437");function i(e,t){var n=Object(r["resolveComponent"])("router-view");return Object(r["openBlock"])(),Object(r["createBlock"])(n)}var c=n("6b0d"),a=n.n(c);const s={},u=a()(s,[["render",i]]);var l=u,p=n("6c02"),h={id:"home"};function d(e,t,n,o,i,c){var a=Object(r["resolveComponent"])("panel"),s=Object(r["resolveComponent"])("progressBar"),u=Object(r["resolveComponent"])("controls"),l=Object(r["resolveComponent"])("el-card"),p=Object(r["resolveComponent"])("el-row");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",h,[Object(r["createVNode"])(p,{class:"row-bg",justify:"center"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,{class:"shell"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a),Object(r["createVNode"])(s),Object(r["createVNode"])(u)]})),_:1})]})),_:1})])}var f={id:"progressBar"};function g(e,t,n,o,i,c){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",f,[Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{class:"progress",ref:"progress",type:"range","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.getProgressBar=e}),onMousedown:t[1]||(t[1]=function(t){return e.change=!0}),onMouseup:t[2]||(t[2]=function(){return c.saveChange&&c.saveChange.apply(c,arguments)}),style:Object(r["normalizeStyle"])({"--progressBar_length":c.active_progressBar_length})},null,36),[[r["vModelText"],c.getProgressBar]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{ref:"voice",class:"voice",type:"range","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.getVoiceBar=e}),style:Object(r["normalizeStyle"])({"--voiceBar_length":c.active_voiceBar_length})},null,4),[[r["vModelText"],c.getVoiceBar]])])}var b=n("ade3"),m=n("1da1"),y=n("d4ec"),v=n("bee2"),j=(n("96cf"),n("b0c0"),n("d3b7"),function(){function e(){Object(y["a"])(this,e),this.audioContext=new AudioContext({latencyHint:"balanced"}),this.gainNode=this.audioContext.createGain(),this.playList=[],this.currentIndex=0,this.autoPlay=!1,this.Volume=.8,this.emptyNode={name:null,index:0,offset:0,start:null,source:null,buffer:null}}return Object(v["a"])(e,[{key:"append",value:function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.playList.length?++this.currentIndex:this.currentIndex=0,console.log("添加完成："+this.currentIndex),e.t0=this.playList,e.t1=t.name,e.t2=this.currentIndex,e.next=7,this.readAudioBuffer(t);case 7:e.t3=e.sent,e.t4={name:e.t1,index:e.t2,offset:0,start:null,source:null,buffer:e.t3},e.t0.push.call(e.t0,e.t4);case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readAudioBuffer",value:function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=new FileReader;o.onload=function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("读取完成"),n.audioContext.decodeAudioData(o.target.result).then(e,r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o.onerror=r,o.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"play",value:function(){var e=this;if(this.playList.length){var t=this.audioContext.createBufferSource();t.buffer=this.current.buffer,t.connect(this.gainNode),this.gainNode.gain.setValueAtTime(this.Volume,this.audioContext.currentTime),this.gainNode.connect(this.audioContext.destination),console.log(this.current.offset),t.start(0,this.current.offset),t.onended=function(){e.autoPlay?e.next():e.stop()},this.current.source=t,this.current.start=this.audioContext.currentTime}}},{key:"voiceControl",value:function(e){this.playList.length&&(this.Volume=e,this.gainNode.gain.setValueAtTime(e,this.audioContext.currentTime))}},{key:"pause",value:function(){this.playList.length&&this.current.source&&(this.current.source.stop(0),this.current.source.disconnect(),this.current.source.onended=null,this.current.source=null,this.current.offset=this.position,this.current.start=null)}},{key:"stop",value:function(){this.pause(),this.current.start=null,this.current.offset=0}},{key:"prev",value:function(){this.stop(),--this.currentIndex,this.currentIndex<0&&(this.currentIndex=this.playList.length-1),this.play()}},{key:"next",value:function(){this.stop(),++this.currentIndex,this.currentIndex>=this.playList.length&&(this.currentIndex=0),this.play()}},{key:"current",get:function(){return this.playList[this.currentIndex]||this.emptyNode}},{key:"duration",get:function(){return this.current.buffer?this.current.buffer.duration:.001}},{key:"position",get:function(){return this.playList.length?this.current.offset+(null!=this.current.start?this.audioContext.currentTime-this.current.start:0):0},set:function(e){this.playList.length&&(this.pause(),this.current.offset=e,this.play())}}]),e}()),O=new j,x=Object(b["a"])({data:function(){return{progressBar_length:"",voiceBar_length:"",screenWidth:document.body.clientWidth}},mounted:function(){var e=this;this.$store.commit("INIT_STATE"),this.progressBar_length=this.$refs.progress.clientWidth,this.voiceBar_length=this.$refs.voice.clientWidth,window.onresize=function(){return function(){window.screenWidth=document.body.clientWidth,e.screenWidth=window.screenWidth}()}},methods:{},watch:{screenWidth:{deep:!0,handler:function(){this.progressBar_length=this.$refs.progress.clientWidth,this.voiceBar_length=this.$refs.voice.clientWidth}}},computed:{active_progressBar_length:function(e){return"".concat(e.progressBar_length*(this.getProgressBar/100),"px")},active_voiceBar_length:function(e){return"".concat(e.voiceBar_length*(this.getVoiceBar/100),"px")},getVoiceBar:{get:function(){return this.$store.state.voiceBar},set:function(e){this.$store.commit("changeVoiceBar",e)}},getProgressBar:{get:function(){return this.$store.state.progressBar},set:function(e){this.$store.commit("changeProgressBar",e)}}}},"methods",{saveChange:function(){this.$store.commit("saveProgress")}});n("5037");const B=a()(x,[["render",g]]);var w=B,k={id:"controls"},N={class:"position"},C={class:"playlist"},V=Object(r["createElementVNode"])("i",{class:"iconfont icon-jiahao"},null,-1),_={key:0,class:"tip"},E={key:1},L=["onClick"];function T(e,t,n,o,i,c){var a=Object(r["resolveComponent"])("el-card");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",k,[i.onplay?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("i",{key:0,class:"iconfont icon-24gf-play",onClick:t[0]||(t[0]=function(){return c.play&&c.play.apply(c,arguments)})})),i.onplay?(Object(r["openBlock"])(),Object(r["createElementBlock"])("i",{key:1,class:"iconfont icon-24gf-pause2",onClick:t[1]||(t[1]=function(){return c.pause&&c.pause.apply(c,arguments)})})):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("i",{class:"iconfont icon-24gf-stop",onClick:t[2]||(t[2]=function(){return c.stop&&c.stop.apply(c,arguments)})}),Object(r["createElementVNode"])("i",{class:"iconfont icon-shangyishou",onClick:t[3]||(t[3]=function(){return c.prev&&c.prev.apply(c,arguments)})}),Object(r["createElementVNode"])("i",{class:"iconfont icon-xiayishou",onClick:t[4]||(t[4]=function(){return c.next&&c.next.apply(c,arguments)})}),Object(r["createElementVNode"])("div",N,Object(r["toDisplayString"])(c.totalTime(e.position))+"/"+Object(r["toDisplayString"])(c.totalTime(e.duration)),1),Object(r["createElementVNode"])("i",{class:"iconfont icon-danlieliebiao",onClick:t[5]||(t[5]=function(){return c.showList&&c.showList.apply(c,arguments)})}),Object(r["createVNode"])(r["Transition"],{name:"el-fade-in"},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",C,[Object(r["createVNode"])(a,{shadow:"always","body-style":{padding:"20px"}},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("input",{type:"file",ref:"file",onChange:t[6]||(t[6]=function(){return c.addListen&&c.addListen.apply(c,arguments)})},null,544),V,0==e.playList.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",_,"还没有添加歌曲呢")):Object(r["createCommentVNode"])("",!0),0==!e.playList.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",E,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.playList,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:t.index,class:Object(r["normalizeClass"])({active:t.index==e.currentIndex}),onClick:function(e){return c.changeSong(t.index)}},Object(r["toDisplayString"])(t.name),11,L)})),128))])):Object(r["createCommentVNode"])("",!0)]})),_:1})],512),[[r["vShow"],i.showlist]])]})),_:1})])}var I=n("5530"),P=(n("99af"),n("5502")),S={data:function(){return{showlist:!0,onplay:!1}},computed:Object(I["a"])(Object(I["a"])({},Object(P["b"])(["onplayName","duration","position","playList","currentIndex"])),{},{totalTime:function(){return function(e){if(0==e)return"00:00";var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t<10?"0":"").concat(t,":").concat(n<10?"0":"").concat(n)}}}),methods:{addListen:function(){0!==this.$refs.file.files.length&&(this.$store.commit("addPlaylist",this.$refs.file.files[0]),O.stop())},play:function(){O.play(),this.onplay=!0},pause:function(){O.pause(),this.onplay=!1},stop:function(){O.stop(),this.onplay=!1},prev:function(){O.prev()},next:function(){O.next()},changeSong:function(e){this.stop(),this.$store.commit("changeSong",e)},showList:function(){this.showlist=!this.showlist}}};n("953d");const $=a()(S,[["render",T]]);var A=$,M={id:"panel"},W={class:"time"},D={class:"position"},R={class:"duration"},z={class:"songName"};function F(e,t,n,o,i,c){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",M,[Object(r["createElementVNode"])("div",W,[Object(r["createElementVNode"])("div",D,Object(r["toDisplayString"])(c.totalTime(e.position)),1),Object(r["createElementVNode"])("div",R,Object(r["toDisplayString"])(c.totalTime(e.duration)),1)]),Object(r["createElementVNode"])("div",z,Object(r["toDisplayString"])(c.songName),1)])}n("ac1f"),n("5319");var H={computed:Object(I["a"])(Object(I["a"])({},Object(P["b"])(["onplayName","duration","position"])),{},{totalTime:function(){return function(e){if(0==e)return"00:00";var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t<10?"0":"").concat(t,":").concat(n<10?"0":"").concat(n)}},songName:function(e){return this.onplayName?this.onplayName.replace(/\.mp3$/,"")||"":"未选择文件"}}),methods:{}};n("3a53");const J=a()(H,[["render",F]]);var U=J,q={components:{controls:A,panel:U,progressBar:w}};n("76eb");const G=a()(q,[["render",d]]);var K=G,Q=[{path:"/",name:"Home",component:K}],X=Object(p["a"])({history:Object(p["b"])(),routes:Q}),Y=X,Z=(n("b680"),Object(P["a"])({state:{voiceBar:80,progressBar:0,onplayName:"",duration:0,position:0,playList:[],currentIndex:0,autoPlay:O.autoPlay,change:!1},mutations:{INIT_STATE:function(e){var t=function t(){window.requestAnimationFrame(t),e.onplayName=O.current.name,e.duration=O.duration,e.currentIndex=O.currentIndex,e.change?e.position=e.duration*e.progressBar/100:(e.position=O.position,e.progressBar=(O.position/O.duration*100).toFixed(2))};t()},addPlaylist:function(e,t){return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,O.append(t);case 2:e.playList.push({name:O.current.name,index:O.current.index}),console.log(e.playList);case 4:case"end":return n.stop()}}),n)})))()},changeVoiceBar:function(e,t){O.voiceControl(t/100),e.voiceBar=t},changeProgressBar:function(e,t){e.change=!0,e.progressBar=t},saveProgress:function(e){O.position=e.position,100==e.progressBar&&O.stop(),e.change=!1},changeSong:function(e,t){O.currentIndex=t}},actions:{},modules:{}}));n("ed2c");Object(r["createApp"])(l).use(Z).use(Y).use(o["a"]).mount("#app")},"76eb":function(e,t,n){"use strict";n("09ac")},"953d":function(e,t,n){"use strict";n("bc23")},bbf8:function(e,t,n){},bc23:function(e,t,n){},cc54:function(e,t,n){},ed2c:function(e,t,n){}});
//# sourceMappingURL=app.0d0bf303.js.map